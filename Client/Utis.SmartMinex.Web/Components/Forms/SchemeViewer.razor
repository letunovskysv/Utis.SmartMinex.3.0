@*--------------------------------------------------------------------------------------------------
// (С) 2017-2025 ООО УралТехИС. Интеллектуальная Системная Платформа 3.0. Все права защищены.
// Описание: SchemeViewer – Просмотр мнемосхемы.
//------------------------------------------------------------------------------------------------*@
@page "/Схема/{Name}"
@inject IDispatcher _dsp

<style>
    .rz-body {
        margin: 0;
        padding: 0;
    }
    #utismap {
        width: 100%;
        height: 100%;
        background: url('images/slice.webp');
    }
</style>

<RadzenMenu Style="background-color:#333;">
    <RadzenMenuItem Text="Тест" Click=@OnTest />
</RadzenMenu>
<div style="width:100%;height:100%;">
    <MapGenius @ref="_map" id="utismap" DataSource=@SchemeModel />
</div>

@code{
    [Parameter]
    public string Name { get; set; }

    MapGenius _map;
    GData? SchemeModel;

    protected override async Task OnInitializedAsync()
    {
        if (_dsp.TryGetObject("Схема." + Name, out var ent) && ent is ZScheme map)
        {
            SchemeModel = new GData(map);
        }
    }

    Task OnTest(MenuItemEventArgs e) => _map.Test();
}
